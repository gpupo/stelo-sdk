#!/usr/bin/env php
<?php

/*
 * This file is part of gpupo/stelo-sdk
 *
 * (c) Gilmar Pupo <g@g1mr.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 *
 * For more information, see
 * <http://www.g1mr.com/stelo-sdk/>.
 */

require __DIR__.'/../vendor/autoload.php';

use Gpupo\SteloSdk\Application;
use Symfony\Component\Console\Input\InputInterface;
use Symfony\Component\Console\Input\InputOption;
use Symfony\Component\Console\Output\OutputInterface;
use Gpupo\SteloSdk\Factory;

$app = new Application();

$transaction_find_parameters = [[
    'key'   => 'transaction_id',
]];

$app->register('transaction:find')
->setDescription('Consulta de transação')
->setDefinition($app->factoryDefinition($transaction_find_parameters))
->setCode(function (InputInterface $input, OutputInterface $output) use ($app, $transaction_find_parameters) {
    $list = $app->processInputParameters($transaction_find_parameters, $input, $output);
    $transaction = $app->factorySdk($list)->factoryManager('transaction')->findById($list['transaction_id']);

    if ($transaction) {
        $output->writeln('<info>Success!</info>');
        $output->writeln($transaction->getStatusCode());
        $output->writeln($transaction->getStatusMessage());
        $output->writeln($transaction->getAmount());
    } else {
        $output->writeln('<error>Not Found</error>');
    }
});

$app->run();
